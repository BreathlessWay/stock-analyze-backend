var Q=Object.defineProperty;var x=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var T=(a,n,t)=>n in a?Q(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,b=(a,n)=>{for(var t in n||(n={}))W.call(n,t)&&T(a,t,n[t]);if(x)for(var t of x(n))X.call(n,t)&&T(a,t,n[t]);return a};var w=(a,n,t)=>new Promise((k,m)=>{var f=i=>{try{c(t.next(i))}catch(r){m(r)}},_=i=>{try{c(t.throw(i))}catch(r){m(r)}},c=i=>i.done?k(i.value):Promise.resolve(i.value).then(f,_);c((t=t.apply(a,n)).next())});import{B as Y}from"./Table-DaAbDyDv.js";import{T as R}from"./TableAction-DNF_hSiS.js";import{ay as Z,au as K,ao as ee,d as te,u as ae,r as u,a as M,L as ne,dC as oe,o as le,f as se,g as B,i as o,w as l,j as v,h as y,t as D,dF as ie,an as ue,N as ce,B as re,dE as de,n as fe,aU as pe}from"./index-BWLoIWRc.js";import{_ as me}from"./CreateModal.vue_vue_type_script_setup_true_lang-Dr2hKL-2.js";import{_ as _e}from"./EditModal.vue_vue_type_script_setup_true_lang-CS_EzUGB.js";import{P as ve}from"./PlusOutlined-CrBjIdVT.js";import"./vuedraggable.umd-P2lE6k1M.js";import"./_commonjsHelpers-CDgoFxsB.js";import"./useDesignSetting-DQ_n429q.js";import"./SettingOutlined-CG8GbWeo.js";import"./propTypes-DDD-Xta1.js";import"./FormOutlined-BJBCE1rA.js";import"./ReloadOutlined--dVEl31o.js";import"./componentSetting-CQq0JJwW.js";import"./index-B3oGedNJ.js";import"./DownOutlined-7KlFnkGg.js";import"./BasicForm-B_ZWkTcA.js";import"./useForm-D_DBoo95.js";import"./useModal-CMBlbpBk.js";function ye(a){return Z.Get("/role/list",{params:a})}const ke=[{title:"id",key:"id"},{title:"角色名称",key:"name"},{title:"说明",key:"explain"},{title:"是否默认角色",key:"isDefault",render(a){return K(ee,{type:a.isDefault?"success":"error"},{default:()=>a.isDefault?"是":"否"})}},{title:"创建时间",key:"create_date"}],he={class:"n-layout-page-header"},ge={class:"py-3 menu-list"},je=te({__name:"role",setup(a){const n=ae(),t=u(),k=u(),m=u(),f=u(!1),_=u(!1),c=u(!1),i=u(""),r=u([]),d=u([]),p=u(["console","step-form"]),A=M({name:"NaiveAdmin"}),N=M({width:250,title:"操作",key:"action",fixed:"right",render(e){return K(R,{style:"button",actions:[{label:"菜单权限",onClick:P.bind(null,e),ifShow:()=>!0,auth:["basic_list"]},{label:"编辑",onClick:F.bind(null,e),ifShow:()=>!0,auth:["basic_list"]},{label:"删除",onClick:H.bind(null,e),ifShow:()=>!0,auth:["basic_list"]}]})}}),U=e=>w(this,null,function*(){let s=b(b({},y(A)),e);return yield ye(s)});function E(){k.value.openModal()}function S(e){console.log(e)}function V(){t.value.reload()}function $(e){e.preventDefault(),_.value=!0,setTimeout(()=>{f.value=!1,n.success("提交成功"),V(),_.value=!1},200)}function F(e){console.log("点击了编辑",e),m.value.showModal(e)}function H(e){console.log("点击了删除",e),n.info("点击了删除")}function P(e){i.value=`分配 ${e.name} 的菜单权限`,p.value=e.menu_keys,f.value=!0}function j(e){p.value=[p.value,...e]}function q(e){d.value=e}function G(){d.value.length?d.value=[]:d.value=r.value.map(e=>e.key)}function I(){c.value?(p.value=[],c.value=!1):(p.value=ie(r.value),c.value=!0)}return ne(()=>w(this,null,function*(){const e=yield oe();d.value=e==null?void 0:e.list.map(s=>s.key),r.value=e==null?void 0:e.list})),(e,s)=>{const C=ue,L=ce,h=re,O=de,z=fe,J=pe;return le(),se("div",null,[B("div",he,[o(C,{bordered:!1,title:"角色权限管理"},{default:l(()=>s[1]||(s[1]=[v(" 页面数据为 Mock 示例数据，非真实数据。 ")])),_:1})]),o(C,{bordered:!1,class:"mt-4 proCard"},{default:l(()=>[o(y(Y),{columns:y(ke),request:U,"row-key":g=>g.id,ref_key:"actionRef",ref:t,actionColumn:N,"onUpdate:checkedRowKeys":S},{tableTitle:l(()=>[o(h,{type:"primary",onClick:E},{icon:l(()=>[o(L,null,{default:l(()=>[o(y(ve))]),_:1})]),default:l(()=>[s[2]||(s[2]=v(" 新增角色 "))]),_:1})]),action:l(()=>[o(y(R))]),_:1},8,["columns","row-key","actionColumn"])]),_:1}),o(J,{show:f.value,"onUpdate:show":s[0]||(s[0]=g=>f.value=g),"show-icon":!1,preset:"dialog",title:i.value},{action:l(()=>[o(z,null,{default:l(()=>[o(h,{type:"info",ghost:"","icon-placement":"left",onClick:G},{default:l(()=>[v(" 全部"+D(d.value.length?"收起":"展开"),1)]),_:1}),o(h,{type:"info",ghost:"","icon-placement":"left",onClick:I},{default:l(()=>[v(" 全部"+D(c.value?"取消":"选择"),1)]),_:1}),o(h,{type:"primary",loading:_.value,onClick:$},{default:l(()=>s[3]||(s[3]=[v("提交")])),_:1},8,["loading"])]),_:1})]),default:l(()=>[B("div",ge,[o(O,{"block-line":"",cascade:"",checkable:"","virtual-scroll":!0,data:r.value,expandedKeys:d.value,"checked-keys":p.value,style:{"max-height":"950px",overflow:"hidden"},"onUpdate:checkedKeys":j,"onUpdate:expandedKeys":q},null,8,["data","expandedKeys","checked-keys"])])]),_:1},8,["show","title"]),o(me,{ref_key:"createModalRef",ref:k},null,512),o(_e,{ref_key:"editModalRef",ref:m},null,512)])}}});export{je as default};
