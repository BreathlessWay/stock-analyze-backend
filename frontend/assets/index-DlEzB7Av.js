var E=(S,m,o)=>new Promise((i,u)=>{var w=n=>{try{c(o.next(n))}catch(r){u(r)}},a=n=>{try{c(o.throw(n))}catch(r){u(r)}},c=n=>n.done?i(n.value):Promise.resolve(n.value).then(w,a);c((o=o.apply(S,m)).next())});import{d as A,r as h,u as B,P as I,a as P,b as U,c as L,e as O,f as j,g as l,t as D,h as C,i as s,w as t,_ as M,o as V,j as N,R as G,N as Z,k as $,l as q,m as T,B as F,n as H,p as J}from"./index-BWLoIWRc.js";import{w as K}from"./website.config-VF84EN91.js";import{P as Q,L as W}from"./PersonOutline-DV2oMpHV.js";const X={class:"view-account"},Y={class:"view-account-container"},ee={class:"view-account-top"},se={class:"view-account-top-desc"},te={class:"view-account-form"},oe={class:"flex justify-between"},ne={class:"flex-initial"},ae=A({__name:"index",setup(S){const m=h(),o=B(),i=h(!1),u=h(!0),w=I.BASE_LOGIN_NAME,a=P({username:"",password:"",isCaptcha:!0}),c={username:{validator(f,e){return/^[a-zA-Z0-9_]{5,10}$/.test(e)?!0:new Error("用户名需要5-10位数字字母_")},trigger:"blur"},password:{validator(f,e){return/^[a-zA-Z0-9_]{5,10}$/.test(e)?!0:new Error("密码需要5-10位数字字母_")},trigger:"blur"}},n=U(),r=L(),b=O(),R=f=>{f.preventDefault(),m.value.validate(e=>E(this,null,function*(){var _;if(e)o.error("请填写完整信息，并且进行验证码校验");else{const{username:v,password:d}=a;o.loading("登录中..."),i.value=!0;const k={operName:v.toString(),passwd:d.toString()};try{const{statusCode:g,message:x}=yield n.login(k);if(o.destroyAll(),g==G.SUCCESS){const y=decodeURIComponent(((_=b.query)==null?void 0:_.redirect)||"/");o.success("登录成功，即将进入系统"),b.name===w?r.replace("/"):r.replace(y)}else o.info(x||"登录失败")}finally{i.value=!1}}}))},z=()=>{r.push({name:"Register"})};return(f,e)=>{const _=Z,v=$,d=q,k=T,g=F,x=H,y=M;return V(),j("div",X,[e[6]||(e[6]=l("div",{class:"view-account-header"},null,-1)),l("div",Y,[l("div",ee,[l("div",se,D(C(K).loginDesc),1)]),l("div",te,[s(y,{ref_key:"formRef",ref:m,"label-placement":"left",size:"large",model:a,rules:c},{default:t(()=>[s(d,{path:"username"},{default:t(()=>[s(v,{value:a.username,"onUpdate:value":e[0]||(e[0]=p=>a.username=p),placeholder:"请输入用户名"},{prefix:t(()=>[s(_,{size:"18",color:"#808695"},{default:t(()=>[s(C(Q))]),_:1})]),_:1},8,["value"])]),_:1}),s(d,{path:"password"},{default:t(()=>[s(v,{value:a.password,"onUpdate:value":e[1]||(e[1]=p=>a.password=p),type:"password",showPasswordOn:"click",placeholder:"请输入密码"},{prefix:t(()=>[s(_,{size:"18",color:"#808695"},{default:t(()=>[s(C(W))]),_:1})]),_:1},8,["value"])]),_:1}),s(d,{class:"default-color"},{default:t(()=>[l("div",oe,[l("div",ne,[s(k,{checked:u.value,"onUpdate:checked":e[2]||(e[2]=p=>u.value=p)},{default:t(()=>e[3]||(e[3]=[N("自动登录")])),_:1},8,["checked"])])])]),_:1}),s(x,{justify:"center"},{default:t(()=>[s(g,{type:"primary",onClick:R,size:"large",loading:i.value},{default:t(()=>e[4]||(e[4]=[N(" 登录 ")])),_:1},8,["loading"]),s(g,{onClick:z,size:"large"},{default:t(()=>e[5]||(e[5]=[N("注册")])),_:1})]),_:1})]),_:1},8,["model"])])])])}}}),ce=J(ae,[["__scopeId","data-v-84e3e748"]]);export{ce as default};
