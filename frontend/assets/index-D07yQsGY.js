var y=(b,f,n)=>new Promise((i,t)=>{var v=a=>{try{l(n.next(a))}catch(u){t(u)}},h=a=>{try{l(n.throw(a))}catch(u){t(u)}},l=a=>a.done?i(a.value):Promise.resolve(a.value).then(v,h);l((n=n.apply(b,f)).next())});import{d as z,r as E,u as N,a as U,b as q,c as B,f as R,g as m,i as r,w as s,_ as L,o as O,h as x,j as k,R as P,N as I,k as V,l as j,B as A,n as D,p as M}from"./index-BWLoIWRc.js";import{P as T,L as C}from"./PersonOutline-DV2oMpHV.js";const F={class:"view-account"},G={class:"view-account-container"},H={class:"view-account-form"},J=z({__name:"index",setup(b){const f=E(),n=N(),i=E(!1),t=U({username:"",password1:"",password2:""}),v={username:{required:!0,validator(d,e){let o=e&&e.trim();return o?o.length<5?new Error("用户名最少5位"):!0:new Error("请输入用户名")},trigger:"blur"},password1:{required:!0,validator(d,e){let o=e&&e.trim();return o?o.length<5?new Error("密码最少5位"):!0:new Error("请输入密码")},trigger:"blur"},password2:{required:!0,validator(d,e){return e?e!==t.password1?new Error("两次输入密码不一致"):!0:new Error("请输入确认密码")},trigger:"blur"}},h=q(),l=B(),a=d=>{d.preventDefault(),f.value.validate(e=>y(this,null,function*(){if(e)n.error("请填写完整信息，并且进行校验");else{const{username:o,password1:p}=t;n.loading("注册中..."),i.value=!0;const c={operName:o.toString(),passwd:p.toString()};try{const{statusCode:w,message:g}=yield h.register(c);if(n.destroyAll(),w==P.SUCCESS)n.success("注册成功，即将进入系统"),yield l.replace("/");else{if(g==="SequelizeUniqueConstraintError")return n.error("用户已存在");n.error(g||"注册失败")}}finally{i.value=!1}}}))},u=()=>{l.push({name:"Login"})};return(d,e)=>{const o=I,p=V,c=j,w=A,g=D,S=L;return O(),R("div",F,[e[6]||(e[6]=m("div",{class:"view-account-header"},null,-1)),m("div",G,[e[5]||(e[5]=m("div",{class:"view-account-top"},[m("div",{class:"view-account-top-desc"},"注册用户")],-1)),m("div",H,[r(S,{ref_key:"formRef",ref:f,"label-placement":"left",size:"large","label-width":"100",model:t,rules:v},{default:s(()=>[r(c,{path:"username",label:"用户名"},{default:s(()=>[r(p,{value:t.username,"onUpdate:value":e[0]||(e[0]=_=>t.username=_),minlength:"5",maxlength:"10",placeholder:"请输入用户名"},{prefix:s(()=>[r(o,{size:"18",color:"#808695"},{default:s(()=>[r(x(T))]),_:1})]),_:1},8,["value"])]),_:1}),r(c,{path:"password1",label:"密码"},{default:s(()=>[r(p,{value:t.password1,"onUpdate:value":e[1]||(e[1]=_=>t.password1=_),minlength:"5",maxlength:"10",type:"password",showPasswordOn:"click",placeholder:"请输入密码"},{prefix:s(()=>[r(o,{size:"18",color:"#808695"},{default:s(()=>[r(x(C))]),_:1})]),_:1},8,["value"])]),_:1}),r(c,{path:"password2",label:"确认密码"},{default:s(()=>[r(p,{value:t.password2,"onUpdate:value":e[2]||(e[2]=_=>t.password2=_),minlength:"5",maxlength:"10",type:"password",showPasswordOn:"click",placeholder:"请输入密码"},{prefix:s(()=>[r(o,{size:"18",color:"#808695"},{default:s(()=>[r(x(C))]),_:1})]),_:1},8,["value"])]),_:1}),r(g,{justify:"center"},{default:s(()=>[r(w,{type:"primary",onClick:a,size:"large",loading:i.value},{default:s(()=>e[3]||(e[3]=[k(" 注册 ")])),_:1},8,["loading"]),r(w,{onClick:u,size:"large"},{default:s(()=>e[4]||(e[4]=[k("登陆")])),_:1})]),_:1})]),_:1},8,["model"])])])])}}}),X=M(J,[["__scopeId","data-v-a5e99049"]]);export{X as default};
